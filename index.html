<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ProTraderHack</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body { background:#0b1220; color:#e6eef8; font-family:Inter,Arial; }
    .screen { display:none; padding:16px; }
    .active { display:block; }
    .nav { position:fixed; bottom:0; left:0; right:0; display:flex; justify-content:space-around; background:#111827; padding:10px; }
    .nav button { flex:1; padding:8px; font-size:14px; }
    .locked { filter: blur(6px); pointer-events: none; }
    .center-lock { display:flex; justify-content:center; align-items:center; height:70vh; }
    .lock-btn { font-size:40px; cursor:pointer; }
  </style>
</head>
<body class="p-4">

  <!-- Auth screen -->
  <div id="authScreen" class="screen active">
    <h2 class="text-xl font-bold mb-4">Welcome to ProTraderHack</h2>
    <input id="username" placeholder="Username (small letters/numbers)" class="w-full p-2 mb-2 rounded bg-gray-900" />
    <input id="email" placeholder="Email" class="w-full p-2 mb-2 rounded bg-gray-900" />
    <input id="password" type="password" placeholder="Password" class="w-full p-2 mb-2 rounded bg-gray-900" />
    <button id="signupBtn" class="w-full py-2 mb-2 rounded bg-green-600">Sign Up</button>
    <button id="loginBtn" class="w-full py-2 mb-2 rounded bg-blue-600">Log In</button>
    <button id="googleBtn" class="w-full py-2 mb-2 rounded bg-red-600">Continue with Google</button>
  </div>

  <!-- Home -->
  <div id="homeScreen" class="screen locked">
    <div id="homeLock" class="center-lock"><span class="lock-btn">🔒</span></div>
    <div id="homeContent" style="display:none;">
      <h2 class="text-xl font-bold">📈 Home</h2>
      <p>Your charts and watchlist will show here.</p>
    </div>
  </div>

  <!-- Search -->
  <div id="searchScreen" class="screen locked">
    <div id="searchLock" class="center-lock"><span class="lock-btn">🔒</span></div>
    <div id="searchContent" style="display:none;">
      <h2 class="text-xl font-bold">🔍 Search</h2>
      <input id="searchBar" placeholder="Search symbol..." class="w-full p-2 mb-2 rounded bg-gray-900" />
      <div id="searchResults"></div>
    </div>
  </div>

  <!-- Admin -->
  <div id="adminScreen" class="screen locked">
    <div id="adminLock" class="center-lock"><span class="lock-btn">🔒</span></div>
    <div id="adminContent" style="display:none;">
      <h2 class="text-xl font-bold">⚙️ Admin Panel</h2>
      <p>Manage keys and users here (admin only).</p>
    </div>
  </div>

  <!-- Account -->
  <div id="accountScreen" class="screen">
    <h2 class="text-xl font-bold">👤 Account</h2>
    <p>Connect your broker below:</p>
    <div id="brokersList">
      <div id="zerodhaBalance">Zerodha: <button onclick="connectBroker('zerodha')">Connect Broker</button></div>
      <div id="angelBalance">AngelOne: <button onclick="connectBroker('angelone')">Connect Broker</button></div>
      <div id="binanceBalance">Binance: <button onclick="connectBroker('binance')">Connect Broker</button></div>
      <div id="exnessBalance">Exness: <button onclick="connectBroker('exness')">Connect Broker</button></div>
    </div>
    <hr class="my-3 border-gray-700" />
    <h3 class="font-semibold mb-2">Funds</h3>
    <button onclick="deposit()" class="w-full py-2 mb-2 rounded bg-green-600">Deposit</button>
    <button onclick="withdraw()" class="w-full py-2 rounded bg-red-600">Withdraw</button>
  </div>

  <!-- Bottom nav -->
  <div class="nav">
    <button onclick="showScreen('homeScreen')">Home</button>
    <button onclick="showScreen('searchScreen')">Search</button>
    <button onclick="showScreen('adminScreen')">Admin</button>
    <button onclick="showScreen('accountScreen')">Account</button>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyC-Vt0JpfAMj9uTdZHXXyot2FvB4lQ_vvE",
      authDomain: "protraderhack-d67f0.firebaseapp.com",
      projectId: "protraderhack-d67f0",
      storageBucket: "protraderhack-d67f0.appspot.com",
      messagingSenderId: "1062485216321",
      appId: "1:1062485216321:web:f34bb52a8acc0a75b24ac0"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    function showScreen(id){
      document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    // Lock/unlock
    document.querySelector("#homeLock .lock-btn").onclick = ()=>unlock('home');
    document.querySelector("#searchLock .lock-btn").onclick = ()=>unlock('search');
    document.querySelector("#adminLock .lock-btn").onclick = ()=>unlock('admin');

    function unlock(type){
      const key = prompt("Enter unlock key:");
      const userKeys = { "pth7":7, "key15":15, "ishaan30":30, "splkey50":50, "ishaan":"perm" };
      const adminKeys = ["vamya","pthowner16"];

      if(type==="home" || type==="search"){
        if(key in userKeys){
          document.getElementById("homeScreen").classList.remove("locked");
          document.getElementById("homeLock").style.display="none";
          document.getElementById("homeContent").style.display="block";
          document.getElementById("searchScreen").classList.remove("locked");
          document.getElementById("searchLock").style.display="none";
          document.getElementById("searchContent").style.display="block";
          alert("✅ Home & Search unlocked!");
        } else {
          alert("❌ Invalid key");
        }
      }

      if(type==="admin"){
        if(adminKeys.includes(key)){
          document.getElementById("adminScreen").classList.remove("locked");
          document.getElementById("adminLock").style.display="none";
          document.getElementById("adminContent").style.display="block";
          alert("✅ Admin unlocked!");
        } else {
          alert("❌ Invalid admin key");
        }
      }
    }

    // Auth
    document.getElementById('signupBtn').onclick = async ()=>{
      const user = document.getElementById('username').value;
      const email = document.getElementById('email').value;
      const pass = document.getElementById('password').value;
      if(!/^[a-z0-9]{1,12}$/.test(user)){ alert("Invalid username!"); return; }
      await auth.createUserWithEmailAndPassword(email,pass);
      localStorage.setItem("username", user);
      showScreen('homeScreen');
    };

    document.getElementById('loginBtn').onclick = async ()=>{
      const email = document.getElementById('email').value;
      const pass = document.getElementById('password').value;
      await auth.signInWithEmailAndPassword(email,pass);
      showScreen('homeScreen');
    };

    document.getElementById('googleBtn').onclick = async ()=>{
      const provider = new firebase.auth.GoogleAuthProvider();
      await auth.signInWithPopup(provider);
      showScreen('homeScreen');
    };

    // Broker logic (placeholder)
    function connectBroker(name){ alert("🔗 Connecting "+name+"..."); }
    function deposit(){ alert("💰 Deposit flow starting..."); }
    function withdraw(){ alert("💸 Withdraw flow starting..."); }
  </script>
</body>
</html>
