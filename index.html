<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ProTraderHack</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js"></script>

  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#0b1220; color:#e6eef8; }
    .container { padding:20px; text-align:center; }
    input, button { padding:10px; margin:5px; border-radius:8px; border:none; }
    input { width:80%; }
    button { cursor:pointer; }
    #signalsList { margin-top:20px; text-align:left; }
    .signal { background:#111a2e; padding:12px; margin-bottom:10px; border-radius:8px; }
    .buy { border-left:5px solid #22c55e; }
    .sell { border-left:5px solid #ef4444; }
    .hold { border-left:5px solid #64748b; }
  </style>
</head>
<body>
  <!-- Login/Signup -->
  <div id="auth-screen" class="container">
    <h2>ðŸ”’ ProTraderHack Login</h2>
    <input id="email" type="email" placeholder="Email"><br>
    <input id="password" type="password" placeholder="Password"><br>
    <button onclick="signup()">Sign Up</button>
    <button onclick="login()">Login</button>
    <button onclick="skipLogin()">Skip</button>
  </div>

  <!-- Home -->
  <div id="home-screen" class="container" style="display:none;">
    <h2>âœ… Welcome to ProTraderHack</h2>
    <button onclick="logout()">Logout</button>

    <h3 style="margin-top:20px;">ðŸ“¢ Live Trading Signals</h3>
    <div id="signalsList"></div>
  </div>

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyC-Vt0JpfAMj9uTdZHXXyot2FvB4lQ_vvE",
      authDomain: "protraderhack-d67f0.firebaseapp.com",
      projectId: "protraderhack-d67f0",
      storageBucket: "protraderhack-d67f0.firebasestorage.app",
      messagingSenderId: "1062485216321",
      appId: "1:1062485216321:web:f34bb52a8acc0a75b24ac0"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Signup
    function signup(){
      const e=document.getElementById("email").value;
      const p=document.getElementById("password").value;
      auth.createUserWithEmailAndPassword(e,p).catch(err=>alert(err.message));
    }
    // Login
    function login(){
      const e=document.getElementById("email").value;
      const p=document.getElementById("password").value;
      auth.signInWithEmailAndPassword(e,p).catch(err=>alert(err.message));
    }
    // Logout
    function logout(){ auth.signOut(); }
    // Skip login
    function skipLogin(){
      document.getElementById("auth-screen").style.display="none";
      document.getElementById("home-screen").style.display="block";
      loadSignals();
    }

    // Auth state
    auth.onAuthStateChanged(user=>{
      if(user){
        document.getElementById("auth-screen").style.display="none";
        document.getElementById("home-screen").style.display="block";
        loadSignals();
      } else {
        document.getElementById("auth-screen").style.display="block";
        document.getElementById("home-screen").style.display="none";
      }
    });

    // Load live signals
    function loadSignals(){
      const list=document.getElementById("signalsList");
      db.collection("signals").orderBy("time","desc").limit(20).onSnapshot(snap=>{
        list.innerHTML="";
        snap.forEach(doc=>{
          const s=doc.data();
          const cls=s.type==="BUY"?"buy":s.type==="SELL"?"sell":"hold";
          list.innerHTML+=`
            <div class="signal ${cls}">
              <strong>${s.symbol}</strong> â†’ ${s.type} @ ${s.price}
              <div style="font-size:12px;opacity:0.8;">${new Date(s.time).toLocaleString()}</div>
            </div>`;
        });
      });
    }
  </script>
</body>
</html>
